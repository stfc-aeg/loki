{

"virtual/bootloader":{
	"globalvar":{
		"SRC_URI_append":" file://config.mk"
	},
	"DefineMethod":{
		"do_compile_prepend ()":{
			"CONFIG_SUBSYSTEM_ARCH_MICROBLAZE":
			["install -d ${B}/source/board/xilinx/microblaze-generic/",
			 "install ${WORKDIR}/config.mk ${B}/source/board/xilinx/microblaze-generic/"]
		}
	}
	},

"virtual/fsboot":{
	"globalvar":{
		"export":"PETALINUX",
		"inherit":"xsctyaml",
		"do_configure[noexec]":["=","!CONFIG_SUBSYSTEM_AUTOCONFIG_FSBOOT", "1"],
		"YAML_FILE_PATH":"${WORKDIR}/fsboot.yaml",
		"YAML_SERIAL_CONSOLE_STDIN_forcevariable":["=","!CONFIG_SUBSYSTEM_SERIAL_MANUAL_SELECT", "CONFIG_SUBSYSTEM_SERIAL_IP_NAME"],
		"YAML_SERIAL_CONSOLE_STDOUT_forcevariable":["=","!CONFIG_SUBSYSTEM_SERIAL_MANUAL_SELECT", "CONFIG_SUBSYSTEM_SERIAL_IP_NAME"],
		"YAML_MAIN_MEMORY_CONFIG":["=","!CONFIG_SUBSYSTEM_MEMORY_MANUAL_SELECT", "CONFIG_SUBSYSTEM_MEMORY_IP_NAME"],
		"YAML_FLASH_MEMORY_CONFIG":["=","!CONFIG_SUBSYSTEM_FLASH_MANUAL_SELECT", "CONFIG_SUBSYSTEM_FLASH_IP_NAME"],
		"sysconf":"${TOPDIR}/../project-spec/configs",
		"FILESEXTRAPATHS_prepend":"${sysconf}:",
		"SYSCONFIG":"${WORKDIR}/config",
		"EXTRA_OEMAKE_APP_append_microblaze":"CFLAGS=-O3\\ -DCONFIG_FS_BOOT_OFFSET=${boot_offset}",
		"hsmoutf":"${WORKDIR}/offsets",
		"SRC_URI_append":"  file://config",
		"XSCTH_PROC_microblaze":"CONFIG_SUBSYSTEM_PROCESSOR0_IP_NAME"
	},
	"DefineMethod":{
                "do_configure_append ()":{"ALL":
			["hsmoutf=\"${WORKDIR}/offsets\"",
			"touch ${hsmoutf}",
			"ipinfof=\"${TOPDIR}/misc/config/data/ipinfo.yaml\"",
			"xsct -sdx -nodisp \"${PETALINUX}/etc/hsm/scripts/petalinux_hsm.tcl\"\\",
			"\"get_flash_width_parts\" \"${SYSCONFIG}\" \"${ipinfof}\"\\",
			"\"${XSCTH_HDF}\" \"${hsmoutf}\""]
			},
		"do_compile_prepend ()":{"ALL":
			["boot_offset=$(egrep -e \"^boot=\" \"${hsmoutf}\" | cut -d \"=\" -f 2 | cut -d \" \" -f 1)"]
			}
	}
	},

"virtual/dtb":{
	"globalvar":{
		"XSCTH_PROC_microblaze":"CONFIG_SUBSYSTEM_PROCESSOR0_IP_NAME"
	}
	}

}
