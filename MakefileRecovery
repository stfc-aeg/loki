all: os

# This makefile requires a LOKI Makefile project

LOKI_DIR=./
APPLICATION_DIR=./loki-recovery/
LOKI_ENV_DIR=./loki-recovery/

# Include recipes to take the environment and run the configuration using the autoconf params
# Provides loki-configure-hw, loki-configure-sw, loki-configure-os
include ${LOKI_DIR}/config.mk

block_design=${LOKI_DIR}/design/block_design/zusys_bd.tcl

.PHONY: all os hardware software project constraints

constraints: loki-configure-hw
	$(MAKE) -C ${LOKI_DIR} constraints CONSTRAINTS_SOURCE_DIR=$(shell pwd)/loki-recovery/

project: loki-configure-hw constraints
	# Instead of actually building the hardware, just make the project in Vivado and stop
	$(MAKE) -C ${LOKI_DIR} project

hardware:
	$(MAKE) -C ${LOKI_DIR} hardware

software: loki-configure-sw hardware
	$(MAKE) -C ${LOKI_DIR} software

os: loki-configure-os software
	$(MAKE) -C ${LOKI_DIR} os

mostlyclean:
	$(MAKE) -C ${LOKI_DIR} mostlyclean

clean:
	$(MAKE) -C ${LOKI_DIR} clean

distclean:
	$(MAKE) -C ${LOKI_DIR} distclean

clobber:
	$(MAKE) -C ${LOKI_DIR} clobber
